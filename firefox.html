<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8"/>
<link rel="alternate"
      type="application/rss+xml"
      href="https://wangz.me/rss.xml"
      title="RSS feed for https://wangz.me/"/>
<title>Firefox 配置及使用 -- wangz.me</title>
<meta name="author" content="Aeghn"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<link href= "static/style.css" rel="stylesheet" type="text/css" />
<link rel="icon" href="static/favicon.ico"/></head>
<body>
<div id="preamble" class="status"><div id="blog-nav">
  <a href="/">wangz's blog </a>
  <span>/ </span>
  <a href="/tags.html">Tags </a>
</div><hr/></div>
<div id="content">
<div class="post-item">
   <div class="post-date"><span class="day">28</span> <span class="month">Jul</span> <span class="year">2020</span></div>
   <div class="post-title-and-tags">
   <h1 class="post-title"><a href="https://wangz.me/firefox.html"> Firefox 配置及使用 </a></h1>

   <div class="post-tags"><a href="https://wangz.me/tag-firefox.html">firefox</a> </div>
   </div>
   </div>
<nav id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org067992f">1. 预览图</a></li>
<li><a href="#org89b5a0f">2. 插件推荐</a>
<ul>
<li><a href="#orgafc3856">2.1. 树状标签栏</a></li>
<li><a href="#org6e3d5f4">2.2. 暗色网页</a></li>
<li><a href="#orgfb23cbc">2.3. rss 工具</a></li>
<li><a href="#org008e1a6">2.4. 下载网页</a></li>
<li><a href="#org5872ec3">2.5. 去广告</a></li>
<li><a href="#org6f4c492">2.6. 隐藏网页图片</a></li>
</ul>
</li>
<li><a href="#org160b3e1">3. 其他设置</a>
<ul>
<li><a href="#org318b40a">3.1. 窗口内全屏</a></li>
</ul>
</li>
<li><a href="#org82b54f9">4. 通过 onmi 来修改按键</a>
<ul>
<li><a href="#org917c67f">4.1. 编辑默认快捷键</a></li>
</ul>
</li>
</ul>
</div>
</nav>


<div id="outline-container-org067992f" class="outline-2">
<h2 id="org067992f"><span class="section-number-2">1.</span> 预览图</h2>
<div class="outline-text-2" id="text-1">
<p>
<a href="https://wangz.me/pics/firefox_screenshot.png">firefox 截图</a>
</p>
</div>
</div>
<div id="outline-container-org89b5a0f" class="outline-2">
<h2 id="org89b5a0f"><span class="section-number-2">2.</span> 插件推荐</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-orgafc3856" class="outline-3">
<h3 id="orgafc3856"><span class="section-number-3">2.1.</span> 树状标签栏</h3>
<div class="outline-text-3" id="text-2-1">
</div>
<div id="outline-container-org1c1b67f" class="outline-4">
<h4 id="org1c1b67f"><span class="section-number-4">2.1.1.</span> 依赖插件</h4>
<div class="outline-text-4" id="text-2-1-1">
<p>
原来使用的 Tree Style Tabs, 现在发现 sidebery 更好看，操作也更友好一些。
</p>

<p>
以上两个插件都是开源的。
</p>

<p>
sidebery 地址：<a href="https://github.com/mbnuqw/sidebery">https://github.com/mbnuqw/sidebery</a>
</p>
</div>
</div>
<div id="outline-container-org5f1bbf2" class="outline-4">
<h4 id="org5f1bbf2"><span class="section-number-4">2.1.2.</span> 隐藏 tabbar</h4>
<div class="outline-text-4" id="text-2-1-2">
<p>
既然使用侧边树状标签栏，就没必要使用 tabbar 了，浪费空间不说，还难用，直接留给我的 i3bar。
</p>
</div>
<ol class="org-ol">
<li><a id="org467c646"></a>配置 <code>about:config</code><br>
<div class="outline-text-5" id="text-2-1-2-1">
<pre class="example">
toolkit.legacyUserProfileCustomizations.stylesheets // 改成 true, 修改此行配置后，才会读取 chrome 文件夹中的配置
browser.tabs.drawInTitlebar // 改为 true
</pre>
</div>
</li>
<li><a id="orgb4db2a5"></a>修改文件 <code>userChrome.css</code><br>
<div class="outline-text-5" id="text-2-1-2-2">
<p>
隐藏标签栏主要是以下几行 css 在发挥作用，文件位于 <code>${FIREFOX_PROFILE}/chrome/userChrome.css</code>
</p>
<div class="org-src-container">
<pre class="src src-css">@namespace url(http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul);

#sidebar-header {
    display: none;
}

#TabsToolbar {
    visibility: collapse !important;
}
#TabsToolbar .tabbrowser-tab {
    display: none !important;
}

#nav-bar[inFullscreen],
#TabsToolbar[inFullscreen] {
    display: none;
}

#TabsToolbar &gt; .titlebar-buttonbox-container {
    display: none !important;
}

</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div id="outline-container-org6e3d5f4" class="outline-3">
<h3 id="org6e3d5f4"><span class="section-number-3">2.2.</span> 暗色网页</h3>
<div class="outline-text-3" id="text-2-2">
</div>
<div id="outline-container-org9487215" class="outline-4">
<h4 id="org9487215"><span class="section-number-4">2.2.1.</span> 依赖插件</h4>
<div class="outline-text-4" id="text-2-2-1">
<p>
Darkreader 开源插件，主要功能为全局使用暗色网页，并且可以根据 firefox 主题自动切换亮暗色。
</p>

<p>
地址：<a href="https://github.com/darkreader/darkreader">https://github.com/darkreader/darkreader</a>
</p>
</div>
</div>
<div id="outline-container-orgf1a6065" class="outline-4">
<h4 id="orgf1a6065"><span class="section-number-4">2.2.2.</span> 修改 toolbar 颜色和 about:blank 颜色</h4>
<div class="outline-text-4" id="text-2-2-2">
<p>
我用的火狐主题是继承的 GTK 主题，为了保持亮暗色下 toolbar 和 about:blank 页面的颜色统一，修改了以下文件，同样是在 chrome1 文件夹下。
</p>
</div>
<ol class="org-ol">
<li><a id="orga961002"></a>配置 <code>userChrome.css</code><br>
<div class="outline-text-5" id="text-2-2-2-1">
<div class="org-src-container">
<pre class="src src-css">#urlbar #urlbar-background,
#urlbar, #urlbar-input-container,
#searchbar, .searchbar-textbox {
    border-radius: 1px !important;
    box-shadow: none !important;
    background: #eeeeee !important;
}

@media (prefers-color-scheme:dark) {
    #urlbar #urlbar-background,
    #urlbar, #urlbar-input-container,
    #searchbar, .searchbar-textbox {
        border-radius: 1px !important;
        box-shadow: none !important;
        background: #4b4b4b !important;
    }
}
</pre>
</div>
</div>
</li>
<li><a id="org5ccd697"></a>配置 <code>userContent.css</code><br>
<div class="outline-text-5" id="text-2-2-2-2">
<div class="org-src-container">
<pre class="src src-css">@media (prefers-color-scheme: dark) {
    @-moz-document url("about:newtab"), url("about:home") {
        body { background-color: #282828 !important;}
    }
}

@media (prefers-color-scheme: light) {
    @-moz-document url("about:newtab"), url("about:home") {
        body { background-color: #eeeeee !important;}
    }
}
</pre>
</div>
</div>
</li>
</ol>
</div>
</div>

<div id="outline-container-orgfb23cbc" class="outline-3">
<h3 id="orgfb23cbc"><span class="section-number-3">2.3.</span> rss 工具</h3>
<div class="outline-text-3" id="text-2-3">
</div>
<div id="outline-container-orgae10d51" class="outline-4">
<h4 id="orgae10d51"><span class="section-number-4">2.3.1.</span> 依赖插件</h4>
<div class="outline-text-4" id="text-2-3-1">
<p>
rss 个人还是感觉和浏览器一直用方便，更新及时，还能直接搭配 ff 的其他插件。
</p>

<p>
此类工具个人体验下来比较好的是 feedbro 和 brief。feedbro 提供了三栏布局，使用上可能更好一点，但是最终选择了 brief ，因为后者开源。
</p>

<p>
地址：<a href="https://github.com/brief-rss/brief">https://github.com/brief-rss/brief</a>
</p>
</div>
</div>
</div>
<div id="outline-container-org008e1a6" class="outline-3">
<h3 id="org008e1a6"><span class="section-number-3">2.4.</span> 下载网页</h3>
<div class="outline-text-3" id="text-2-4">
</div>
<div id="outline-container-org232f57e" class="outline-4">
<h4 id="org232f57e"><span class="section-number-4">2.4.1.</span> 依赖插件</h4>
<div class="outline-text-4" id="text-2-4-1">
<p>
singlefile，将整个网页下载到一个文件，适合我这样有收藏癖的人（不过现在主要用浏览器外的 monilith 了）。
</p>

<p>
地址：<a href="https://github.com/gildas-lormeau/SingleFile">https://github.com/gildas-lormeau/SingleFile</a>
</p>
</div>
</div>
</div>
<div id="outline-container-org5872ec3" class="outline-3">
<h3 id="org5872ec3"><span class="section-number-3">2.5.</span> 去广告</h3>
<div class="outline-text-3" id="text-2-5">
</div>
<div id="outline-container-orge5e1dec" class="outline-4">
<h4 id="orge5e1dec"><span class="section-number-4">2.5.1.</span> 依赖插件</h4>
<div class="outline-text-4" id="text-2-5-1">
<p>
ublock origin 简单好用，足够稳定。
</p>

<p>
地址：<a href="https://github.com/gorhill/uBlock">https://github.com/gorhill/uBlock</a>
</p>
</div>
</div>
</div>
<div id="outline-container-org6f4c492" class="outline-3">
<h3 id="org6f4c492"><span class="section-number-3">2.6.</span> 隐藏网页图片</h3>
<div class="outline-text-3" id="text-2-6">
</div>
<div id="outline-container-org611b82d" class="outline-4">
<h4 id="org611b82d"><span class="section-number-4">2.6.1.</span> 依赖插件</h4>
<div class="outline-text-4" id="text-2-6-1">
<p>
hide-images 划水必备插件。
</p>

<p>
地址：<a href="https://github.com/sur98ke/hide-images-ff-quantum">https://github.com/sur98ke/hide-images-ff-quantum</a>
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-org160b3e1" class="outline-2">
<h2 id="org160b3e1"><span class="section-number-2">3.</span> 其他设置</h2>
<div class="outline-text-2" id="text-3">
</div>
<div id="outline-container-org318b40a" class="outline-3">
<h3 id="org318b40a"><span class="section-number-3">3.1.</span> 窗口内全屏</h3>
<div class="outline-text-3" id="text-3-1">
<p>
如果需要在窗口内全屏的话，即隐藏 toolbar 和 tabbar 的话，那么可以使用以下 <code>about:config</code> 中的 flag:
将 <code>full-screen-api.ignore-widgets</code> 改为 <code>true</code> 。
用来小窗看视频还是挺方便的。
</p>
</div>
</div>
</div>
<div id="outline-container-org82b54f9" class="outline-2">
<h2 id="org82b54f9"><span class="section-number-2">4.</span> 通过 onmi 来修改按键</h2>
<div class="outline-text-2" id="text-4">
</div>
<div id="outline-container-org917c67f" class="outline-3">
<h3 id="org917c67f"><span class="section-number-3">4.1.</span> 编辑默认快捷键</h3>
<div class="outline-text-3" id="text-4-1">
<p>
如果想要编辑 firefox 量子的默认快捷键，比较方便的是编辑 omni.ja 。
</p>
</div>
<div id="outline-container-orgba24906" class="outline-4">
<h4 id="orgba24906"><span class="section-number-4">4.1.1.</span> 得到 omni.ja 文件</h4>
<div class="outline-text-4" id="text-4-1-1">
<p>
在 Archlinux 下可以通过
</p>
<div class="org-src-container">
<pre class="src src-bash">$ pacman -Ql firefox | grep omni.ja
firefox /usr/lib/firefox/browser/omni.ja
firefox /usr/lib/firefox/omni.ja
</pre>
</div>
<p>
如上得到了两个 omni.ja 文件，我们只需要编辑第一个文件就可以了。
</p>
</div>
</div>
<div id="outline-container-org642f92d" class="outline-4">
<h4 id="org642f92d"><span class="section-number-4">4.1.2.</span> 解压 omni.ja 文件</h4>
<div class="outline-text-4" id="text-4-1-2">
<p>
注意：请备份 omni.ja 文件
</p>

<p>
omni.ja 可以直接通过 <code>unzip</code> 进行解压，在 Linux 下不妨参照如下命令：
</p>
<div class="org-src-container">
<pre class="src src-bash">$ cp /usr/lib/firefox/browser/omni.ja $HOME/omni.ja.bak
$ mkdir -p $HOME/temp_omni_ja # 创建临时文件夹
$ cd $HOME/temp_omni_ja
$ unzip ../omni.ja.bak
</pre>
</div>
</div>
</div>
<div id="outline-container-org87458a0" class="outline-4">
<h4 id="org87458a0"><span class="section-number-4">4.1.3.</span> 编辑快捷键</h4>
<div class="outline-text-4" id="text-4-1-3">
</div>
<ol class="org-ol">
<li><a id="org6bc4bd6"></a>两个文件<br>
<div class="outline-text-5" id="text-4-1-3-1">
<p>
现在就进入了正题，要开始编辑快捷键了。
</p>

<p>
需要注意两个文件：
</p>
<pre class="example">
localization/en-US/browser/browserSets.ftl
</pre>
<p>
这个里面存放的是诸如
</p>
<pre class="example">
window-minimize-shortcut =
 .key = M
</pre>
<p>
这样的定义，相当于为每个 key 取了一个名称，例子中的 M 就是键盘上的 M 键。
</p>

<p>
还有就是
</p>
<pre class="example">
chrome/browser/content/browser/browser.xhtml
</pre>
<p>
这个文件了，这个里面就是我们需要着重修改的地方。
</p>
</div>
</li>
<li><a id="orgff6a735"></a>一个例子，使用 &lt;C-s&gt; 搜索<br>
<div class="outline-text-5" id="text-4-1-3-2">
<p>
如果想使用 &lt;C-s&gt; 进行类似 Emacs 中的向下搜索，在 firefox 中这个动作的默认快捷键是 &lt;C-g&gt;, 既然 ff 中有还有字母的这个快捷键，那么在 <code>localization/en-US/browser/browserSets.ftl</code> 就应该有 <code>G</code> 这个定义，要做的就变成了中找到 <code>G</code> 并改成 <code>S</code>, 结果如下：
</p>
<pre class="example">
search-find-again-shortcut =
       .key = G
</pre>
<p>
将它修改成
</p>
<pre class="example">
search-find-again-shortcut =
       .key = S
</pre>
</div>
</li>
<li><a id="orgb3dc390"></a>又一个例子，使用 &lt;M-n&gt; 到下一个标签<br>
<div class="outline-text-5" id="text-4-1-3-3">
<p>
这个例子相对就麻烦一些，因为在 <code>chrome/browser/content/browser/browser.xhtml</code> 中默认没有 &lt;M-j&gt; 类似的快捷键。就不能直接在 <code>localization/en-US/browser/browserSets.ftl</code> 直接修改定义来完成这个了。
</p>

<p>
但是通过阅读文件，发现该文件中存在着切换到下一个标签的命令
</p>
<div class="org-src-container">
<pre class="src src-xhtml">&lt;command id="Browser:NextTab" oncommand="gBrowser.tabContainer.advanceSelectedTab(1, true);"/&gt;
</pre>
</div>
<p>
那么要做的就变成了添加快捷键，照猫画虎，在 <code>&lt;keyset id="mainKeyset"&gt;</code> 一节中添加如下命令即可：
</p>
<pre class="example">
&lt;key id="goNextTabKb"
     data-l10n-id="window-new-shortcut"
     command="Browser:NextTab"
     modifiers="alt"/&gt;
</pre>
<p>
需要说明的是， <code>data-l10n-id</code> 就是在 <code>localization/en-US/browser/browserSets.ftl</code> 中定义的 key, 在该文件中有
</p>
<pre class="example">
window-new-shortcut =
      .key = N
</pre>
<p>
我需要的是 &lt;M-n&gt; 切换到下一个标签，然后就偷了懒，没有改名称，直接拿过来用了。剩下的几个就是字面意思，没啥好说的。
</p>
</div>
</li>
<li><a id="org633979d"></a>其他<br>
<div class="outline-text-5" id="text-4-1-3-4">
<p>
不想要的直接注释掉就好了
</p>

<p>
我的修改记录在这： <a href="https://pastebin.com/G7aLMqsv">https://pastebin.com/G7aLMqsv</a>
</p>
</div>
</li>
</ol>
</div>
<div id="outline-container-org76c3ca6" class="outline-4">
<h4 id="org76c3ca6"><span class="section-number-4">4.1.4.</span> 重新打包</h4>
<div class="outline-text-4" id="text-4-1-4">
<p>
等到修改满意以后要做的就是怎么拿出来怎么送回去了。
官方推荐的是 <code>zip -qr9XD omni.ja *</code> 这样进行打包，所以
</p>
<div class="org-src-container">
<pre class="src src-bash">$ zip -qr9XD $HOME/omni.ja *
$ sudo cp $HOME/omni.ja /usr/lib/firefox/browser/omni.ja
</pre>
</div>
</div>
</div>
<div id="outline-container-org4fc1552" class="outline-4">
<h4 id="org4fc1552"><span class="section-number-4">4.1.5.</span> 启动 firefox</h4>
<div class="outline-text-4" id="text-4-1-5">
<p>
首先需要使用 <code>firefox --purgecaches</code> 来重载 omni.ja, 这样修改的才会生效。
</p>
</div>
</div>

<div id="outline-container-orgf951ea2" class="outline-4">
<h4 id="orgf951ea2"><span class="section-number-4">4.1.6.</span> 配置 Vimium</h4>
<div class="outline-text-4" id="text-4-1-6">
<p>
页面内导航，我选用了 vimium, 然后将 Vimium 的快捷键修改了一下。
</p>
<div class="org-src-container">
<pre class="src src-bash">unmapAll
map n scrollDown
map p scrollUp
map &lt;a-v&gt; scrollToTop
map &lt;c-v&gt; scrollToBottom
map &lt;a-w&gt; copyCurrentUrl
map &lt;a-c&gt; enterVisualMode
map &lt;a-C&gt; enterVisualLineMode
map j LinkHints.activateMode
map &lt;a-j&gt; LinkHints.activateModeToOpenInNewTab
</pre>
</div>
</div>
</div>

<div id="outline-container-orgdb6c819" class="outline-4">
<h4 id="orgdb6c819"><span class="section-number-4">4.1.7.</span> 后话</h4>
<div class="outline-text-4" id="text-4-1-7">
<p>
firefox 差不多就比较接近 vanilla emacs 的键位了，我也可以愉快地使用了。
</p>
</div>
</div>

<div id="outline-container-orgf2fb790" class="outline-4">
<h4 id="orgf2fb790"><span class="section-number-4">4.1.8.</span> 参考</h4>
<div class="outline-text-4" id="text-4-1-8">
<ul class="org-ul">
<li><a href="https://developer.mozilla.org/en-US/docs/Mozilla/About_omni.ja_(formerly_omni.jar)">https://developer.mozilla.org/en-US/docs/Mozilla/About_omni.ja_(formerly_omni.jar)</a></li>
<li><a href="https://superuser.com/questions/1533417/configure-disable-firefox-keyboard-shortcuts">https://superuser.com/questions/1533417/configure-disable-firefox-keyboard-shortcuts</a></li>
<li><a href="https://github.com/philc/vimium">https://github.com/philc/vimium</a></li>
</ul>
</div>
</div>
</div>
</div>
<div id="post-meta"><div class="post-tags">相关标签：<a href="https://wangz.me/tag-firefox.html">firefox</a> </div><div class="post-date-published">最后更新：2021-11-28</div><div class="post-date-created">首次发布：2020-07-28</div><div class="post-tags">联系邮箱：aeghnAToutlookDOTcom</div></div>
<div id="other-posts">
<a href="https://wangz.me/index.html">其他帖子</a>
</div>
</div>
<div id="postamble" class="status">
<center><span> Powered by Org-mode and</span> <a href="https://github.com/aeghn/org-static-blog"> a fork</a><span> of</span><a href="https://github.com/bastibe/org-static-blog"> org-static-blog</a> </center></div>
</body>
</html>
