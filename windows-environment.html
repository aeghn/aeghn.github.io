<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<link rel="alternate"
      type="application/rss+xml"
      href="https://wangz.me/rss.xml"
      title="RSS feed for https://wangz.me/">
<title>Windows Environment</title>
<meta name="author" content="Aeghn">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href= "static/style.css" rel="stylesheet" type="text/css" />
<link rel="icon" href="static/favicon.ico"></head>
<body>
<div id="preamble" class="status"><div id="blog-nav">
  <a href="/">wangz's blog </a>
  <span>/ </span>
  <a href="/tags.html">Tags </a>
</div><hr/></div>
<div id="content">
<div class="post-item">
   <h1 class="post-title"><a href="https://wangz.me/windows-environment.html"> Windows Environment </a></h1>

   <div class="post-date-and-tags">
   <div class="post-date">2021-09-10</div>
   <div class="post-tags"><a href="https://wangz.me/tag-windows.html">Windows</a> <a href="https://wangz.me/tag-emacs.html">Emacs</a> </div>
   </div>
   </div>
<nav id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org5121ae0">1. Emacs 相关配置</a>
<ul>
<li><a href="#org1eda086">1.1. 使用 Msys2 安装依赖</a></li>
<li><a href="#orgbdf66fa">1.2. 编译 Emacs 并安装</a></li>
<li><a href="#org1234212">1.3. 其他设置</a></li>
</ul>
</li>
</ul>
</div>
</nav>

<figure id="orga4962b2">
<img src="./files/windows-environment-shadow.png" alt="windows-environment-shadow.png">

</figure>

<div id="outline-container-org5121ae0" class="outline-2">
<h2 id="org5121ae0"><span class="section-number-2">1.</span> Emacs 相关配置</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-org1eda086" class="outline-3">
<h3 id="org1eda086"><span class="section-number-3">1.1.</span> 使用 Msys2 安装依赖</h3>
<div class="outline-text-3" id="text-1-1">
<div class="org-src-container">
<pre class="src src-shell">$ pacman -S --needed base-devel \
  mingw-w64-x86_64-toolchain \
  mingw-w64-x86_64-xpm-nox \
  mingw-w64-x86_64-libtiff \
  mingw-w64-x86_64-giflib \
  mingw-w64-x86_64-libpng \
  mingw-w64-x86_64-libjpeg-turbo \
  mingw-w64-x86_64-librsvg \
  mingw-w64-x86_64-lcms2 \
  mingw-w64-x86_64-jansson \
  mingw-w64-x86_64-libxml2 \
  mingw-w64-x86_64-gnutls \
  mingw-w64-x86_64-zlib \
  mingw-w64-x86_64-harfbuzz
</pre>
</div>
</div>
</div>
<div id="outline-container-orgbdf66fa" class="outline-3">
<h3 id="orgbdf66fa"><span class="section-number-3">1.2.</span> 编译 Emacs 并安装</h3>
<div class="outline-text-3" id="text-1-2">
<p>
笔者写了个脚本，用来编译 Emacs 并安装
</p>
<div class="org-src-container">
<pre class="src src-shell">#!/usr/bin/env bash

set -e

SCRIPT_PATH="$0"
DIR_PATH="${SCRIPT_PATH%/*}"
EMACS_SRC_DIR="/e/repos/emacs"

cd "$EMACS_SRC_DIR"

./autogen.sh
./configure \
    --without-pop \
    --with-native-compilation \
    --enable-link-time-optimization \
    --with-dbus \
    --with-sound=no

make NATIVE_FULL_AOT=1 -j$(nproc)
make install

# 我统一在一个目录中管理我的所有配置文件，但是 Windows 缺乏对应软链接工具，所以在初始化 Emacs 配置之前，我需要指定真正的配置文件位置
cat &lt;&lt;EOF &gt; "C:/msys64/mingw64/share/emacs/site-lisp/site-start.el"
(setenv "HOME" (concat "C:/msys64/home/" (getenv "USER")))
(setq user-init-file "$DIR_PATH/init.el")
(load user-init-file)
EOF
</pre>
</div>
</div>
</div>

<div id="outline-container-org1234212" class="outline-3">
<h3 id="org1234212"><span class="section-number-3">1.3.</span> 其他设置</h3>
<div class="outline-text-3" id="text-1-3">
</div>
<div id="outline-container-org8d4e05b" class="outline-4">
<h4 id="org8d4e05b"><span class="section-number-4">1.3.1.</span> 创建快捷方式</h4>
<div class="outline-text-4" id="text-1-3-1">
<ol class="org-ol">
<li>任务栏固定 emacs.exe</li>
<li><p>
修改属性 (alt + shift + right click)，将其中的地址修改为
</p>
<pre class="example">
C:\msys64\mingw64\bin\emacsclientw.exe -n -c -a ""
</pre></li>
</ol>
</div>
</div>

<div id="outline-container-org1585580" class="outline-4">
<h4 id="org1585580"><span class="section-number-4">1.3.2.</span> 禁用 Ctrl-Space</h4>
<div class="outline-text-4" id="text-1-3-2">
<p>
Ctrl-Space 在 Windows 中默认用来切换输入法，但是笔者更习惯使用它来切换选择标记。网上提供了很多方法来对其进行切换，包括使用 AutoHotKey 等软件，但是 Windows 10 中提供设置禁用切换输入法这个功能。
</p>

<p>
具体方法为：
</p>
<ol class="org-ol">
<li>在托盘区域的输入法上右键单击。</li>
<li>进入 <code>设置</code> 。</li>
<li>进入 <code>按键</code> 设置</li>
<li>在 <code>模式切换</code> 中反选 <code>Ctrl+Space</code></li>
</ol>
<p>
此时 Windows 就不会拦截该快捷键，可以用于 Emacs 编辑相关的键位绑定中。
</p>
</div>
</div>
<div id="outline-container-org3955039" class="outline-4">
<h4 id="org3955039"><span class="section-number-4">1.3.3.</span> 绑定 <code>s-x</code> 启动 Emacs</h4>
<div class="outline-text-4" id="text-1-3-3">
<p>
使用 autoHotKey
</p>
<div class="org-src-container">
<pre class="src src-ahk">LWin &amp; x::
  emacsclient --no-wait -a "" -e "(if (frame-focus-state) (lower-frame) (raise-frame))"
Return
</pre>
</div>
</div>
</div>
</div>
</div>

<div id="other-posts">
<a href="https://wangz.me/index.html">Other posts</a>
</div>
</div>
<div id="postamble" class="status">
<div id="blog-tail">
<center><span> Powered by Org-mode and</span> <a href="https://github.com/aeghn/org-static-blog"> a fork</a><span> of</span><a href="https://github.com/bastibe/org-static-blog"> org-static-blog</a> </center>
</div></div>
</body>
</html>
